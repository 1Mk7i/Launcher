<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="css/Bachet.css">
	<link rel="stylesheet" href="/Launcher/src/styles/index.css">
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
	<title>BachetGame</title>
	<script src="js/main.js"></script>
	<script src="js/world.js"></script>
	<script src="js/bots.js"></script>
</head>
<body class="menu2">

	<div class="Back">
        <a class="btn btn-primary back" href="/Launcher/src/pages/hometaskPages/AI/AI.html">←</a>
    </div>

	<div class="panel2">
		<div class="info" style="color: rgb(255, 255, 255); margin: 0, 0, 200px, 0;"></div>
	</div>

	<div class="static-panel-info">
		<h5>Всі боти:</h5>
		<div class="all-bots" id="allBots" style="color: black;"></div>
		<h5>Останні дії:</h5>
		<div class="last-actions" id="lastActions" style="color: black;"></div>
	</div>

	<button type="button" class="hideStaticPanel" onclick="hideStaticPanel('off')" style="position: fixed; bottom: 75px;">Hide</button>

	<div class="staticPanel" style="z-index: 999;">
		<div class="btn-group" role="group" aria-label="Basic example">
			<button type="button" class="btn btn-primary statPanelButton" onclick="location.reload()">Reset</button>
		</div>
		<button type="button" class="btn btn-primary statPanelButton" onclick="keepNoMoreThanKBestBotsOfClass()">Keep 10 best</button>
		<input type="text" id="char" value="" style="width: 20px;" onchange="char = this.value;" placeholder="Evo Name">
		<button type="button" class="btn btn-primary statPanelButton" onclick="createDescendantsOfBotsOfClass()">Create descendants</button>
		<button type="button" class="btn btn-primary statPanelButton" onclick="showAllBots()">Show all bots</button>
		<button type="button" class="btn btn-primary statPanelButton" onclick="playTournaments()">Play tournaments</button>
		<input type="text" id="n" value="" style="width: 20px;" onchange="n = this.value;" placeholder="N">
		<button type="button" class="btn btn-primary statPanelButton" onclick="createDescendantsOfBotsOfClassManyTimes(n)">Create descendants N times</button>
	</div>

	<div class="panel2">
		<div id="chart"></div>
	</div>
	<div class="panel2">
		<div id="scatterPlot"></div>
	</div>

<script src="js/index.js"></script>
<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>

<script>
    function getScore(num) {
        let scores = [];
        for (let i = 0; i < num; i++) {
            console.log("ROUND_" + i);
            let evoRes = window.world.findAverageTournamentResultOfBotsOfClass(EvoBot);
            let modRes = window.world.findAverageTournamentResultOfBotsOfClass(EvoBotMod);
            let bestRes = window.world.findAverageTournamentResultOfBotsOfClass(Bot123);
            scores.push([evoRes / bestRes, modRes / bestRes]);
            window.world.keepNoMoreThanKBestBotsOfClass(EvoBot, 10);
            window.world.keepNoMoreThanKBestBotsOfClass(EvoBotMod, 10);
            window.world.createDescendantsOfBotsOfClass(EvoBot, "A" + i);
            window.world.createDescendantsOfBotsOfClass(EvoBotMod, "B" + i);
            window.world.startTournamentBetweenBots(window.world.allBots, 100, 2, false);
        }
        console.log(scores);

        // Побудова лінійного графіка
        let trace1 = {
            x: scores.map((score, index) => index), // раунди
            y: scores.map(score => score[0]), // значення для EvoBot
            mode: 'lines',
            type: 'scatter',
            name: 'EvoBot',
            line: {
                color: 'rgb(55, 128, 191)',
                width: 3
            }
        };

        let trace2 = {
            x: scores.map((score, index) => index), // раунди
            y: scores.map(score => score[1]), // значення для EvoBotMod
            mode: 'lines',
            type: 'scatter',
            name: 'EvoBotMod',
            line: {
                color: 'rgb(219, 64, 82)',
                width: 3
            }
        };

        let data = [trace1, trace2];

        let layout = {
            title: 'Графік',
            xaxis: {
                title: 'Раунд'
            },
            yaxis: {
                title: 'Значення'
            },
            legend: {
                x: 0.8,
                y: 1
            }
        };

        Plotly.newPlot('scatterPlot', data, layout);
    }
</script>

</body>
<script src="/Launcher/src/js/index.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</html>